#!/bin/bash
set -ex
WORKSPACE="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

export ORFS=~/OpenROAD-flow-scripts
export FLOW_HOME=$ORFS/flow
export MAKEFILES=$FLOW_HOME/Makefile

if [[ $WORKSPACE = * ]]
then
    export BUILD_DIR=$(echo $WORKSPACE | sed 's|external/bazel-orfs~override|execroot/_main|')
else
    export BUILD_DIR=$WORKSPACE
fi

export WORK_HOME=$BUILD_DIR/$RULEDIR

# Make bazel-bin writable
chmod -R +w $WORK_HOME

source $ORFS/env.sh

"$@"
